{
  "valid": [
    {
      "description": "output from output",
      "arguments": {
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 OP_2 OP_CHECKMULTISIG"
      },
      "options": {},
      "expected": {
        "m": 2,
        "n": 2,
        "name": "p2ms(2 of 2)",
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 OP_2 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002"
        ],
        "signatures": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "output from m/pubkeys",
      "arguments": {
        "m": 1,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002"
        ]
      },
      "expected": {
        "m": 1,
        "n": 2,
        "name": "p2ms(1 of 2)",
        "output": "OP_1 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 OP_2 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002"
        ],
        "signatures": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "input/output from m/pubkeys/signatures",
      "arguments": {
        "m": 2,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002",
          "030000000000000000000000000000000000000000000000000000000000000003"
        ],
        "signatures": [
          "300602010002010001",
          "300602010102010001"
        ]
      },
      "expected": {
        "m": 2,
        "n": 3,
        "name": "p2ms(2 of 3)",
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 030000000000000000000000000000000000000000000000000000000000000003 OP_3 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002",
          "030000000000000000000000000000000000000000000000000000000000000003"
        ],
        "signatures": [
          "300602010002010001",
          "300602010102010001"
        ],
        "input": "OP_0 300602010002010001 300602010102010001",
        "witness": []
      }
    },
    {
      "description": "input/output from output/signatures",
      "arguments": {
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 030000000000000000000000000000000000000000000000000000000000000003 OP_3 OP_CHECKMULTISIG",
        "signatures": [
          "300602010002010001",
          "300602010102010001"
        ]
      },
      "expected": {
        "m": 2,
        "n": 3,
        "name": "p2ms(2 of 3)",
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 030000000000000000000000000000000000000000000000000000000000000003 OP_3 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002",
          "030000000000000000000000000000000000000000000000000000000000000003"
        ],
        "signatures": [
          "300602010002010001",
          "300602010102010001"
        ],
        "input": "OP_0 300602010002010001 300602010102010001",
        "witness": []
      }
    },
    {
      "description": "input/output from input/output",
      "arguments": {
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 030000000000000000000000000000000000000000000000000000000000000003 OP_3 OP_CHECKMULTISIG",
        "input": "OP_0 300602010002010001 300602010102010001"
      },
      "expected": {
        "m": 2,
        "n": 3,
        "name": "p2ms(2 of 3)",
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 030000000000000000000000000000000000000000000000000000000000000003 OP_3 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002",
          "030000000000000000000000000000000000000000000000000000000000000003"
        ],
        "signatures": [
          "300602010002010001",
          "300602010102010001"
        ],
        "input": "OP_0 300602010002010001 300602010102010001",
        "witness": []
      }
    },
    {
      "description": "input/output from input/output, even if incomplete",
      "arguments": {
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 OP_2 OP_CHECKMULTISIG",
        "input": "OP_0 OP_0 300602010102010001"
      },
      "options": {
        "allowIncomplete": true
      },
      "expected": {
        "m": 2,
        "n": 2,
        "name": "p2ms(2 of 2)",
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 OP_2 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002"
        ],
        "signatures": [
          0,
          "300602010102010001"
        ],
        "input": "OP_0 OP_0 300602010102010001",
        "witness": []
      }
    },
    {
      "description": "input/output from output/signatures, even if incomplete",
      "arguments": {
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 OP_2 OP_CHECKMULTISIG",
        "signatures": [
          0,
          "300602010102010001"
        ]
      },
      "options": {
        "allowIncomplete": true
      },
      "expected": {
        "m": 2,
        "n": 2,
        "name": "p2ms(2 of 2)",
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 OP_2 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002"
        ],
        "signatures": [
          0,
          "300602010102010001"
        ],
        "input": "OP_0 OP_0 300602010102010001",
        "witness": []
      }
    },
    {
      "description": "output from output (20-of-20 multisig)",
      "arguments": {
        "output": "14 0255355ca83c973f1d97ce0e3843c85d78905af16b4dc531bc488e57212d230116 03e3e592638b492e642f8c389f9577b0809d4f73032c4c0f9981cb57cb3eebbe4c 02b0a4e912141c3b1044cdc13f196ff95c916f05f43d04184b7dcefa6977fac24a 02958361ee738c994b5e799c13c964602915eaa847ed7e5a5a3f8c42312cd39a61 0227654f4d0ddea28183970c7532692fadf8dd042e31a51c5936f85487c5a1ec02 02c38b046055858679daf9468ac44c991cce4bf91f9f8f4eab6ea7f9d2041e499f 0335676ec077b748a253dd92a1ca9387533818e511741281ebc96d61eccd86cf39 03165f2a7bbd0789c795f66ca0c383d963fa17bf4289d9faae8b8b8f098b3e669f 032c3263ced2ce21ac62ff8828f67cf12a4cc3cb93edfd432ea4a1cba2d533bae8 0304f4f8a3039ab91a1bbe211a1e16b80b549d9feffb4b83cd9e4d43d7e55964d1 03e3dfe07b7c83bdd7908795f890ba8de2117fc3303d048edd54a72de1183ed737 02ef28db8ca852fd8f871835d31a600728cf1f76744dc6b22c9d36394d146a04e5 03ce600e3f61f8b72de1715654010fa54da7a12d39b8d8cb9969f160888eaa2e0e 02df6d74c70b197cf0fc65216ab5ce25b120338a02049a45907f6e54b2e7c779b8 029f5f53b28673bb834c082f3ccd4e73c1a2099368fe7b8567cb817b7675531e26 023ccd807197e3af4139ad4647a0350bef5829f41651729defac3863e964cd3cb1 02482d77f0fb886bb23d9c431960933499982f6ecaf45f2e279203dbe642aca03b 02312b2cac8fb58150596ce11f7db6a50775d257fb8f9bdd1a3e129eef10ea182c 038c6bd3d819d30aa07cb52a2ca4aaaaf83e63bc9947a9e0230abe5233af1c12dd 038e3b9db1442165010102596f30536020e451b6e645ef1fb0c21cb965f84e3eee 14 OP_CHECKMULTISIG"
      },
      "options": {},
      "expected": {
        "m": 20,
        "n": 20,
        "name": "p2ms(20 of 20)",
        "output": "14 0255355ca83c973f1d97ce0e3843c85d78905af16b4dc531bc488e57212d230116 03e3e592638b492e642f8c389f9577b0809d4f73032c4c0f9981cb57cb3eebbe4c 02b0a4e912141c3b1044cdc13f196ff95c916f05f43d04184b7dcefa6977fac24a 02958361ee738c994b5e799c13c964602915eaa847ed7e5a5a3f8c42312cd39a61 0227654f4d0ddea28183970c7532692fadf8dd042e31a51c5936f85487c5a1ec02 02c38b046055858679daf9468ac44c991cce4bf91f9f8f4eab6ea7f9d2041e499f 0335676ec077b748a253dd92a1ca9387533818e511741281ebc96d61eccd86cf39 03165f2a7bbd0789c795f66ca0c383d963fa17bf4289d9faae8b8b8f098b3e669f 032c3263ced2ce21ac62ff8828f67cf12a4cc3cb93edfd432ea4a1cba2d533bae8 0304f4f8a3039ab91a1bbe211a1e16b80b549d9feffb4b83cd9e4d43d7e55964d1 03e3dfe07b7c83bdd7908795f890ba8de2117fc3303d048edd54a72de1183ed737 02ef28db8ca852fd8f871835d31a600728cf1f76744dc6b22c9d36394d146a04e5 03ce600e3f61f8b72de1715654010fa54da7a12d39b8d8cb9969f160888eaa2e0e 02df6d74c70b197cf0fc65216ab5ce25b120338a02049a45907f6e54b2e7c779b8 029f5f53b28673bb834c082f3ccd4e73c1a2099368fe7b8567cb817b7675531e26 023ccd807197e3af4139ad4647a0350bef5829f41651729defac3863e964cd3cb1 02482d77f0fb886bb23d9c431960933499982f6ecaf45f2e279203dbe642aca03b 02312b2cac8fb58150596ce11f7db6a50775d257fb8f9bdd1a3e129eef10ea182c 038c6bd3d819d30aa07cb52a2ca4aaaaf83e63bc9947a9e0230abe5233af1c12dd 038e3b9db1442165010102596f30536020e451b6e645ef1fb0c21cb965f84e3eee 14 OP_CHECKMULTISIG",
        "pubkeys": [
          "0255355ca83c973f1d97ce0e3843c85d78905af16b4dc531bc488e57212d230116",
          "03e3e592638b492e642f8c389f9577b0809d4f73032c4c0f9981cb57cb3eebbe4c",
          "02b0a4e912141c3b1044cdc13f196ff95c916f05f43d04184b7dcefa6977fac24a",
          "02958361ee738c994b5e799c13c964602915eaa847ed7e5a5a3f8c42312cd39a61",
          "0227654f4d0ddea28183970c7532692fadf8dd042e31a51c5936f85487c5a1ec02",
          "02c38b046055858679daf9468ac44c991cce4bf91f9f8f4eab6ea7f9d2041e499f",
          "0335676ec077b748a253dd92a1ca9387533818e511741281ebc96d61eccd86cf39",
          "03165f2a7bbd0789c795f66ca0c383d963fa17bf4289d9faae8b8b8f098b3e669f",
          "032c3263ced2ce21ac62ff8828f67cf12a4cc3cb93edfd432ea4a1cba2d533bae8",
          "0304f4f8a3039ab91a1bbe211a1e16b80b549d9feffb4b83cd9e4d43d7e55964d1",
          "03e3dfe07b7c83bdd7908795f890ba8de2117fc3303d048edd54a72de1183ed737",
          "02ef28db8ca852fd8f871835d31a600728cf1f76744dc6b22c9d36394d146a04e5",
          "03ce600e3f61f8b72de1715654010fa54da7a12d39b8d8cb9969f160888eaa2e0e",
          "02df6d74c70b197cf0fc65216ab5ce25b120338a02049a45907f6e54b2e7c779b8",
          "029f5f53b28673bb834c082f3ccd4e73c1a2099368fe7b8567cb817b7675531e26",
          "023ccd807197e3af4139ad4647a0350bef5829f41651729defac3863e964cd3cb1",
          "02482d77f0fb886bb23d9c431960933499982f6ecaf45f2e279203dbe642aca03b",
          "02312b2cac8fb58150596ce11f7db6a50775d257fb8f9bdd1a3e129eef10ea182c",
          "038c6bd3d819d30aa07cb52a2ca4aaaaf83e63bc9947a9e0230abe5233af1c12dd",
          "038e3b9db1442165010102596f30536020e451b6e645ef1fb0c21cb965f84e3eee"
        ],
        "signatures": null,
        "input": null,
        "witness": null
      }
    }
  ],
  "invalid": [
    {
      "exception": "Not enough data",
      "arguments": {}
    },
    {
      "exception": "Not enough data",
      "arguments": {
        "m": 2
      }
    },
    {
      "exception": "Not enough data",
      "arguments": {
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002"
        ]
      }
    },
    {
      "description": "Non OP_INT chunk (m)",
      "exception": "Output is invalid",
      "arguments": {
        "output": "OP_RESERVED"
      }
    },
    {
      "description": "Non OP_INT chunk (n)",
      "exception": "Output is invalid",
      "arguments": {
        "output": "OP_1 OP_RESERVED"
      }
    },
    {
      "description": "Missing OP_CHECKMULTISIG",
      "exception": "Output is invalid",
      "arguments": {
        "output": "OP_1 OP_2 OP_RESERVED"
      }
    },
    {
      "description": "m is 0",
      "exception": "Invalid opcode: expected OP_1–OP_16, got 0",
      "arguments": {
        "output": "OP_0 OP_2 OP_CHECKMULTISIG"
      }
    },
    {
      "description": "n is 0 (m > n)",
      "exception": "Invalid opcode: expected OP_1–OP_16, got 0",
      "arguments": {
        "output": "OP_2 OP_0 OP_CHECKMULTISIG"
      }
    },
    {
      "description": "m > n",
      "exception": "Output is invalid",
      "arguments": {
        "output": "OP_3 OP_2 OP_CHECKMULTISIG"
      }
    },
    {
      "description": "n !== output pubkeys",
      "exception": "Output is invalid",
      "options": {},
      "arguments": {
        "output": "OP_1 030000000000000000000000000000000000000000000000000000000000000001 OP_2 OP_CHECKMULTISIG"
      }
    },
    {
      "description": "Non-canonical output public key",
      "exception": "Output is invalid",
      "arguments": {
        "output": "OP_1 ffff OP_1 OP_CHECKMULTISIG"
      }
    },
    {
      "exception": "n mismatch",
      "arguments": {
        "n": 2,
        "output": "OP_1 030000000000000000000000000000000000000000000000000000000000000001 OP_1 OP_CHECKMULTISIG"
      }
    },
    {
      "exception": "m mismatch",
      "arguments": {
        "m": 2,
        "output": "OP_1 030000000000000000000000000000000000000000000000000000000000000001 OP_1 OP_CHECKMULTISIG"
      }
    },
    {
      "exception": "Pubkeys mismatch",
      "options": {},
      "arguments": {
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001"
        ],
        "output": "OP_1 030000000000000000000000000000000000000000000000000000000000000002 OP_1 OP_CHECKMULTISIG"
      }
    },
    {
      "exception": "Pubkey count mismatch",
      "arguments": {
        "m": 2,
        "n": 3,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002"
        ]
      }
    },
    {
      "exception": "Pubkey count cannot be less than m",
      "arguments": {
        "m": 4,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000001"
        ]
      }
    },
    {
      "exception": "Not enough signatures provided",
      "arguments": {
        "m": 2,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000001"
        ],
        "signatures": [
          "300602010002010001"
        ]
      }
    },
    {
      "exception": "Signature mismatch",
      "arguments": {
        "m": 1,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000001"
        ],
        "signatures": [
          "300602010002010001"
        ],
        "input": "OP_0 300602010002010101"
      }
    },
    {
      "exception": "Too many signatures provided",
      "arguments": {
        "m": 2,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000001"
        ],
        "signatures": [
          "300602010002010001",
          "300602010002010001",
          "300602010002010001"
        ]
      }
    },
    {
      "description": "Missing OP_0",
      "exception": "Input is invalid",
      "options": {},
      "arguments": {
        "m": 2,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000001"
        ],
        "input": "OP_RESERVED"
      }
    },
    {
      "exception": "Input has invalid signature\\(s\\)",
      "arguments": {
        "m": 1,
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001"
        ],
        "input": "OP_0 ffffffffffffffff"
      }
    },
    {
      "description": "n > 20 (2-of-21 multisig)",
      "exception": "Output is invalid",
      "arguments": {
        "output": "OP_2 020000000000000000000000000000000000000000000000000000000000000001 020000000000000000000000000000000000000000000000000000000000000002 020000000000000000000000000000000000000000000000000000000000000003 020000000000000000000000000000000000000000000000000000000000000004 020000000000000000000000000000000000000000000000000000000000000005 020000000000000000000000000000000000000000000000000000000000000006 020000000000000000000000000000000000000000000000000000000000000007 020000000000000000000000000000000000000000000000000000000000000008 020000000000000000000000000000000000000000000000000000000000000009 02000000000000000000000000000000000000000000000000000000000000000a 02000000000000000000000000000000000000000000000000000000000000000b 02000000000000000000000000000000000000000000000000000000000000000c 02000000000000000000000000000000000000000000000000000000000000000d 02000000000000000000000000000000000000000000000000000000000000000e 02000000000000000000000000000000000000000000000000000000000000000f 020000000000000000000000000000000000000000000000000000000000000010 020000000000000000000000000000000000000000000000000000000000000011 020000000000000000000000000000000000000000000000000000000000000012 020000000000000000000000000000000000000000000000000000000000000013 020000000000000000000000000000000000000000000000000000000000000014 15 OP_CHECKMULTISIG"
      }
    }
  ],
  "dynamic": {
    "depends": {
      "m": [ "output" ],
      "n": [ "output", [ "m", "pubkeys" ] ],
      "output": [ "output", [ "m", "pubkeys" ] ],
      "pubkeys": [ "output" ],
      "signatures": [ ["input", "output"] ],
      "input": [ ["signatures", "output"] ],
      "witness": [ ["input", "output"] ]
    },
    "details": [
      {
        "description": "p2ms",
        "m": 2,
        "n": 3,
        "output": "OP_2 030000000000000000000000000000000000000000000000000000000000000001 030000000000000000000000000000000000000000000000000000000000000002 030000000000000000000000000000000000000000000000000000000000000003 OP_3 OP_CHECKMULTISIG",
        "pubkeys": [
          "030000000000000000000000000000000000000000000000000000000000000001",
          "030000000000000000000000000000000000000000000000000000000000000002",
          "030000000000000000000000000000000000000000000000000000000000000003"
        ],
        "signatures": [
          "300602010002010001",
          "300602010102010001"
        ],
        "input": "OP_0 300602010002010001 300602010102010001",
        "witness": []
      }
    ]
  }
}
